<!doctype html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Elemental RTS</title>
    <script src="vendor/phaser.min.js"></script>
    <style>
        html {
            padding: 0;
        }

        body {
            margin: 0;
        }
    </style>
</head>
<body>
<script type="text/javascript">
    window.onload = function () {
        var height = window.innerHeight;
        var width = window.innerWidth;

        console.log("Window Height:", height);
        console.log("Window Width:", width);

        var game = new Phaser.Game(width, height, Phaser.AUTO, '', {
            preload: preload,
            create: create,
            update: update,
            render: render
        });

        game.width = width;
        game.height = height;

        var keyFTen; // Full Screen

        var map;
        var tileset;
        var layer;
        var player;
        var cursors;
        var bg;

        function preload() {
            // Map
            game.load.tilemap('test-map', 'assets/tiled/test-map.json', null, Phaser.Tilemap.TILED_JSON);
            game.load.image('grass-tiles-2-small', 'assets/tiled/tileset/grass-tiles-2-small.png');
            game.load.image('tree2-final', 'assets/tiled/tileset/tree2-final.png');
        }

        function create() {
            // Key Mappings
            keyFTen = game.input.keyboard.addKey(Phaser.KeyCode.F10);

            // Set scale mode (maintain aspect ratio)
            game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;

            // Set camera size
            game.camera.setSize(width, height);

            // Bind input for full screen
            keyFTen.onDown.add(function () {
                goFullScreen();
            }, this);


            // Load in the map!
            map = game.add.tilemap('test-map');

            map.addTilesetImage('grass-tiles-2-small');
            map.addTilesetImage('tree2-final');

            layer = map.createLayer(0);
            layer.resizeWorld();


            game.physics.startSystem(Phaser.Physics.P2JS);
            player = game.add.sprite(game.world.centerX, game.world.centerY, 'player');
            game.physics.p2.enable(player);
            cursors = game.input.keyboard.createCursorKeys();
            game.camera.follow(player);

        }

        function update() {
            var speed = 1200;
            player.body.setZeroVelocity();

            if (cursors.up.isDown)
            {
                player.body.moveUp(speed)
            }
            else if (cursors.down.isDown)
            {
                player.body.moveDown(speed);
            }

            if (cursors.left.isDown)
            {
                player.body.velocity.x = -speed;
            }
            else if (cursors.right.isDown)
            {
                player.body.moveRight(speed);
            }
        }

        function render() {
            game.debug.cameraInfo(game.camera, 32, 32);
            game.debug.spriteCoords(player, 32, 500);

        }

        function goFullScreen() {
            if (game.scale.isFullScreen) {
                game.scale.stopFullScreen();
            }
            else {
                game.scale.startFullScreen(false);
            }

        }

    };


</script>

</body>
</html>